Этот небольшой проект создан для использования на посту охраны поселка, работающего с системой "Е-Поселок" и призванный решить отдельные ее проблемы:

- **зависимость от наличия интернета** (при плохой связи распознавание номеров перестает работать),
- **странно организованный поиск** (при вводе цифр номера в поиск, выпадают все номера когда-либо бывшие в системе, в том числе те, на которые пропуск сейчас отсутствует),
- **невозможность создать пропуск по неполному номеру** (популярный запрос от жителей: пропустить машину только по цифрами номера, в течение текущего дня),
- **короткая история хранения распознанных номеров, проезд по которым был запрещен** (машина проезжает без пропуска, когда ее пускает охранник или проезжает следом за другой машиной, эти события желательно фиксировать для дальнейших разборов, откуда машина взялась в поселке)


![Image](https://github.com/user-attachments/assets/42a4abce-db97-4967-8ebd-7b4533671f88)


Слева -- поиск по базе Е-Поселка (хранится локально, синхронизируется каждый час) и по базе временных номеров. Справа - ведение списка временных номеров. Внизу - кнопки управления шлагбаумами (позволяет контролировать, когда вручную шлагбаум поднимался, также позволяет фиксировать шлагбаум в поднятом состоянии).


![Image](https://github.com/user-attachments/assets/07225a4d-b840-41fe-bf1e-df95af1e46ff)


При проезде проверка сначала идет по локальной базе, обновляемой раз в час из Е-Поселка, потом по локальной базе временных номеров, если ничего не найдено -- идет запрос в Е-Поселок, на случай если номер оттуда еще не успел попасть в локальную базу. В истории проездов видно, на основании чего был открыт шлагбаум.

Если сервер недоступен, то скрипт проверяет номер сразу напрямую в Е-Поселке.

Интерфейс оптимизирован под работу на планшете, но работоспособен и с компьютера и со смартфона.

Реализована работа с [реле сарапульских систем](https://sprecord.ru/products/gsm-rele-cl-gate/), калитка управляется через [домофон Сокол](https://doc.is74.ru/books/umnyi-domofon-sokol-plius/page/api-dokumentaciia). Можно легко адаптировать под работу с другим реле, управляемым при помощи REST API.

### Использование

Серверную часть (main.py и папку templates) нужно запустить на каком-либо компьютере, установив на него python и пакеты:

```
pip install requests flask APScheduler

```

Интерфейс будет доступен по ссылке [http://localhost:5000](http://localhost:5000)

gate.py необходимо перенести на компьютер где работает программа распознавания номеров и настроить вызов этого скрипта по распознаванию номера, передавая распознанный номер как параметр.

В gate.py и main.py необходимо прописать значения переменных в верхней части -- адреса, логины, пароли и тд.

